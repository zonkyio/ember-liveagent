{"version":3,"file":"liveagent.js","sources":["../../src/services/liveagent.ts"],"sourcesContent":["import Service from '@ember/service';\n\ndeclare global {\n  interface Window {\n    embedded_svc?: EmbeddedService;\n  }\n}\n\ninterface LiveAgentConfig {\n  salesforceURL: string;\n  communityURL: string;\n  org: string;\n  snapinName: string;\n  baseLiveAgentContentURL: string;\n  deploymentId: string;\n  buttonId: string;\n  baseLiveAgentURL: string;\n  eswLiveAgentDevName: string;\n}\n\ninterface BaseSettings {\n  displayHelpButton?: boolean;\n  language?: string;\n  defaultMinimizedText?: string;\n  loadingText?: string;\n  prepopulatedPrechatFields?: Record<string, string>;\n  offlineSupportMinimizedText?: string;\n  enabledFeatures?: string[];\n  entryFeature?: string;\n  storageDomain?: string;\n  extraPrechatFormDetails?: (string | number | boolean)[];\n  extraPrechatInfo?: (string | number | boolean)[];\n  domain: string;\n  isOfflineSupportEnabled: boolean;\n}\n\ninterface ConfigOptions {\n  baseLiveAgentContentURL: string;\n  deploymentId: string;\n  buttonId: string;\n  baseLiveAgentURL: string;\n  eswLiveAgentDevName: string;\n  isOfflineSupportEnabled: boolean;\n}\n\ninterface EmbeddedService {\n  settings: BaseSettings;\n  init(\n    salesforceURL: string,\n    communityURL: string,\n    gslbBaseURL: string,\n    org: string,\n    string: string,\n    options: ConfigOptions,\n  ): void;\n  hideHelpButton(): void;\n  showHelpButton(): void;\n}\n\ninterface Options extends LiveAgentConfig {\n  settings: BaseSettings;\n}\n\nexport default class LiveAgentService extends Service {\n  isFastBoot = typeof FastBoot !== 'undefined';\n\n  boot(options: Options) {\n    if (this.isFastBoot) {\n      return;\n    }\n    if (!window.embedded_svc) {\n      const { salesforceURL } = options;\n\n      const s = document.createElement('script');\n      s.setAttribute('src', `${salesforceURL}/embeddedservice/5.0/esw.min.js`);\n      s.onload = () => {\n        this._initESW('https://service.force.com', options);\n      };\n      document.body.appendChild(s);\n    } else {\n      this._initESW('https://service.force.com', options);\n    }\n  }\n\n  _initESW(gslbBaseURL: string, options: Options) {\n    if (!window.embedded_svc) {\n      return;\n    }\n\n    const svc = window.embedded_svc;\n    svc.settings = svc.settings || {};\n\n    const {\n      salesforceURL,\n      communityURL,\n      org,\n      snapinName,\n      baseLiveAgentContentURL,\n      deploymentId,\n      buttonId,\n      baseLiveAgentURL,\n      eswLiveAgentDevName,\n    } = options;\n\n    const {\n      displayHelpButton = false,\n      language = 'en',\n      domain,\n      defaultMinimizedText = 'Chat with an Expert',\n      loadingText = 'Loading',\n      isOfflineSupportEnabled = false,\n      offlineSupportMinimizedText = 'Contact Us',\n      prepopulatedPrechatFields = {},\n      extraPrechatFormDetails = [],\n      extraPrechatInfo = [],\n    } = options.settings;\n\n    svc.settings.displayHelpButton = displayHelpButton;\n    svc.settings.language = language;\n    svc.settings.defaultMinimizedText = defaultMinimizedText;\n    svc.settings.loadingText = loadingText;\n    svc.settings.prepopulatedPrechatFields = prepopulatedPrechatFields;\n    svc.settings.offlineSupportMinimizedText = offlineSupportMinimizedText;\n    svc.settings.enabledFeatures = ['LiveAgent'];\n    svc.settings.entryFeature = 'LiveAgent';\n\n    if (domain) {\n      svc.settings.storageDomain = domain;\n    }\n\n    svc.settings.extraPrechatFormDetails = extraPrechatFormDetails;\n    svc.settings.extraPrechatInfo = extraPrechatInfo;\n\n    svc.init(salesforceURL, communityURL, gslbBaseURL, org, snapinName, {\n      baseLiveAgentContentURL,\n      deploymentId,\n      buttonId,\n      baseLiveAgentURL,\n      eswLiveAgentDevName,\n      isOfflineSupportEnabled,\n    });\n  }\n\n  hideHelpButton() {\n    window.embedded_svc?.hideHelpButton();\n  }\n\n  showHelpButton() {\n    window.embedded_svc?.showHelpButton();\n  }\n}\n"],"names":["LiveAgentService","Service","isFastBoot","FastBoot","boot","options","window","embedded_svc","salesforceURL","s","document","createElement","setAttribute","onload","_initESW","body","appendChild","gslbBaseURL","svc","settings","communityURL","org","snapinName","baseLiveAgentContentURL","deploymentId","buttonId","baseLiveAgentURL","eswLiveAgentDevName","displayHelpButton","language","domain","defaultMinimizedText","loadingText","isOfflineSupportEnabled","offlineSupportMinimizedText","prepopulatedPrechatFields","extraPrechatFormDetails","extraPrechatInfo","enabledFeatures","entryFeature","storageDomain","init","hideHelpButton","showHelpButton"],"mappings":"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"}